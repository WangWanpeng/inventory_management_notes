
\subsection{$(Q,r)$ Model}

\subsubsection{Computing the service level}

The service level is
\begin{equation}
  \label{eq:5}
  \begin{split}
   S(Q,r) 
   &= \frac1Q \sum_{i=r}^{r+Q-1} S(i) \\
   &= \frac1Q \sum_{i=r}^{r+Q-1} G(i),
  \end{split}
\end{equation}
where $S(i)$ is the service level of the basestock model with reorder
level $i$, i.e. $S(i)=G(i)$ is given by \eqref{eq:13}.  To verify that
the summation should start at $r$, and not at $r+1$ (as I have found
somewhere), we can take $Q=1$, as then the $(Q,r)$ model reduces to
the basestock model. The above formula then gives $S(1,r)= G(r)$, and
this is the same formula as found for the basestock model, i.e.,
\eqref{eq:13}.


Factory Physics mentions also the following formula:
\begin{equation}
  \label{eq:1}
   S(Q,r) = 1- \frac1Q [B(r-1) - B(r+Q-1)],
\end{equation}
where $B(r)$ can be computed according to \eqref{eq:12}.  I find
expression \eqref{eq:5} conceptually more important than \eqref{eq:1}. 

\begin{remark}
  
It
appears that in Eq. 2.70 of FP, edition 3, are is off by one. To see
this, we prove that \eqref{eq:1} is indeed the same as \eqref{eq:5}. It
follows from \eqref{eq:1} and \eqref{eq:5} that
\begin{equation*}
  \begin{split}
   B(r-1) - B(r+Q-1) 
   &= Q - Q S(Q,r) \\
   &= Q - \sum_{i=r}^{r+Q-1} S(i) \\
   &= \sum_{i=r}^{r+Q-1}(1- S(i)) \\
   &= \sum_{i=r}^{r+Q-1}(1- G(i)),
  \end{split}
\end{equation*}
since $\sum_{i=r}^{r+Q-1} 1 = Q$. From \eqref{eq:13} we see that $S(i)
= G(i)$. With \eqref{eq:18} this becomes
\begin{equation*}
  \begin{split}
    B(r-1) - B(r+Q-1)
    &= \sum_{i=r}^{r+Q-1}(1- G(i))\\
    &= \sum_{i=r}^{r+Q-1} \bar G(i)\\
    &= \sum_{i=r}^{\infty} \bar G(i) -\sum_{i=r+Q}^\infty \bar G(i).
  \end{split}
\end{equation*}
From \eqref{eq:19} it follows that $B(r-1)=\sum_{i=r}^{\infty} \bar
G(i)$, and likewise for $B(r-1+Q)$. We are done.
\end{remark}

\subsubsection{Computing  backorders}

The expected number of back-orders is 
\begin{equation}
  \label{eq:14}
   B(Q,r) = \frac1Q \sum_{i=r}^{r+Q-1} B(i),
\end{equation}
where $B(i)$ is defined in \eqref{eq:12}. To convince ourselves
that the summation has to start at $r$, observe that for
$Q=1$, we get \eqref{eq:12} of the basestock model.


\subsubsection{Expected Inventory Level}

The expected inventory level can be found as follows. Let $I(r)$
be the long-run time average inventory level, i.e., \eqref{eq:6}. Then,

\begin{equation}\label{eq:2}
  \begin{split}
   I(Q,r)
   &= \frac1Q\sum_{i=r}^{r+Q-1} I(i) \\
   &= \frac1Q\sum_{i=r}^{r+Q-1} (i+1 - \theta + B(r)) \\
   &= \frac1Q\sum_{i=r}^{r+Q-1} (i + 1)  - \theta + \frac1Q\sum_{i=r}^{r+Q-1} B(r) \\
   &= \frac{Q+1}2 + r - \theta + B(Q,r), 
  \end{split}
\end{equation}
where we use \eqref{eq:14}. What do you get when $Q=1$?

Formulas to skip (in edition 3): 2.38, 2.41, 2.42, 2.43.

\begin{question}
  Take the data from Exercise~\ref{q:basestock}. Suppose $r=1$ and $Q=2$. What is $S(Q,r)$?
\end{question}
\begin{solution}
  Use~\eqref{eq:5}.
  \begin{equation*}
    \begin{split}
      S(2,1)
&= \frac{1}Q\sum_{i=r}^{r+Q-1} G(i) \\
&= \frac{1}Q\sum_{i=r}^{r+Q-1} \P{X\leq i} \\
&= \frac{1}Q\sum_{i=1}^{1+2-1} \P{X\leq i} \\
&= \frac 12 \sum_{i=1}^{2} \P{X\leq i} \\
&=  \frac 12 (\P{X\leq 1} + P{X\leq 2}) \\
&= \frac12(11/30 + 37/60) = 59/120.
    \end{split}
  \end{equation*}
\end{solution}

\begin{question}
  Take the data from Exercise~\ref{q:basestock}. Suppose $r=1$ and $Q=2$. What is $B(Q,r)$?
\end{question}
\begin{solution}
Use~\eqref{eq:14} and the results of Exercise~\ref{q:basestock_B}
  \begin{equation*}
    \begin{split}
      B(2,1)
&= \frac1Q \sum_{i=r}^{r+Q-1} B(i) \\
&= \frac12 \sum_{i=1}^{2} B(i) \\
&= \frac12 (B(1) + B(2)) \\
&= \frac12 \left(\frac{97}{120} + \frac{17}{40}\right) = \frac{37}{60}.
\end{split}
\end{equation*}
\end{solution}


\begin{question}
  Take the data from Exercise~\ref{q:basestock}. Suppose $r=1$ and $Q=2$. What is $I(Q,r)$?
\end{question}
\begin{solution}
  Use~\eqref{eq:2} and the previous exercise and the result of Exercise~\ref{q:basestock_theta}.

  \begin{equation*}
    I(2,1)  = \frac{2+1}2 + r - \frac{91}{40}+ \frac{37}{60} = \frac{101}{120}.
  \end{equation*}
\end{solution}


\subsubsection{Simulation of the (Q,r) inventory model}

Consider a periodic-time model so that the inventory position $\IP_i$
is the inventory position at the end of period $i$. Then the sequence
$\{\IP_i\}$ must satisfy the recursion:
\begin{equation}
  \IP_i = \IP_{i-1} - D_i + Q \1{\IP_{i-1} - D_i\leq r}.
\end{equation}
To see this, observe that under the $(Q,r)$ policy the inventory
position is always kept above level $r$. Thus, if the inventory
position at the end of period $i-1$ minus the demand $D_i$ during
period $i$ is less than $r+1$, we need to place a replenishment
reorder of size $Q$.  Note that we assume here that $D_i\leq Q$ always.

When the leadtime $L$ is one period or more, the replenishments do not
arrive right away but $L$ periods later. The consequences of the
inventory level are that
\begin{equation}
  \IL_i = \IL_{i-1} - D_i + Q\1{\IP_{i-1-L} - D_{i-L}\leq r}.
\end{equation}
Compare~\eqref{eq:21} of the basestock model.

The performance measures are the same as for the basestock model discussed in Section~\ref{sec:simul-basest-invent}.


\subsubsection{Example Code}
\label{sec:qr_example-code}

Here is the code by which we computed the answers to the exercises. We include it for the interested student; feel free to skip it otherwise.

\lstinputlisting[language=Python]{basestock.py}


%%% Local Variables:
%%% mode: latex
%%% TeX-master: "notes_all"
%%% End:
